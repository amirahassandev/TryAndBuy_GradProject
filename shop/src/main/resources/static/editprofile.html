<!DOCTYPE html>
<html lang="en">
<!-- Basic -->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- Mobile Metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Site Metas -->
    <title>SAN Shop</title>
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Site Icons -->
    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <!-- Site CSS -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/edit-profile.css">
    <!-- Responsive CSS -->
    <link rel="stylesheet" href="css/responsive.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/custom.css">
    <script src="js/holder.js" defer></script>

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>


    <!-- Start Main Top -->
    <header class="main-header">
        <!-- Start Navigation -->
       <div id="navPlaceholder"></div>
        <!-- End Navigation -->
    </header>
    <!-- End Main Top -->



    <!-- Start All Title Box -->
    <div class="all-title-box">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <h2>My Account</h2>
                    <ul class="breadcrumb">
                        <li class="breadcrumb-item"><a href="#">Shop</a></li>
                        <li class="breadcrumb-item active">Edit Account</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <!-- End All Title Box -->
      <div class="cont">
        <form id="editProfileForm">
          <div id="message" style="color: green; margin-bottom: 10px;"></div>
      
          <div class="row">
            <div class="col-25">
              <label for="email" class="lab">Email (read only)</label>
            </div>
            <div class="col-75">
              <input type="text" class="il" name="email" id="email" readonly>
            </div>
          </div>
      
          <div class="row">
            <div class="col-25">
              <label for="firstName" class="lab">Fullname</label>
            </div>
            <div class="col-75">
              <input type="text" class="il" name="fullname" id="fullname" placeholder="Your fullname..">
            </div>
          </div>
      
          <div class="row">
            <div class="col-25">
              <label for="lastName" class="lab">username</label>
            </div>
            <div class="col-75">
              <input type="text" class="il" name="username" id="username" placeholder="Your username..">
            </div>
          </div>
      
          <div class="row">
            <div class="col-25">
              <label for="phone" class="lab">Phone</label>
            </div>
            <div class="col-75">
              <input type="text" class="il" name="phone" id="phone" placeholder="Your Phone..">
            </div>
          </div>
      
          <div class="row">
            <div class="col-25">
              <label for="address" class="lab">Address</label>
            </div>
            <div class="col-75">
              <input type="text" class="il" name="address" id="address" placeholder="Your Address..">
            </div>
          </div>
      
          <div class="row">
            <div class="col-25">
              <label for="product_img" class="lab">Upload Image</label><br>
              <input type="file" id="picture" name="picture"  />
              <img id="previewImage" class="image-preview" />
            </div>
          </div>
      
          <br>
      
          <div class="row">
            <input type="button" value="Submit" id="sub">
          </div>
        </form>
      </div>
      
    <!-- End My Account -->

    <!-- Start Instagram Feed  -->
    <!-- Start Instagram Feed  -->
    <div class="instagram-box">
    <div class="main-instagram owl-carousel owl-theme">
        <div class="item">
            <div class="ins-inner-box">
                <img src="../images/instagram-img-01.jpg" alt="" />
                <div class="hov-in">
                    <a href="#"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
        </div>
        <div class="item">
            <div class="ins-inner-box">
                <img src="../images/instagram-img-02.jpg" alt="" />
                <div class="hov-in">
                    <a href="#"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
        </div>
        <div class="item">
            <div class="ins-inner-box">
                <img src="../images/instagram-img-03.jpg" alt="" />
                <div class="hov-in">
                    <a href="#"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
        </div>
        <div class="item">
            <div class="ins-inner-box">
                <img src="../images/instagram-img-04.jpg" alt="" />
                <div class="hov-in">
                    <a href="#"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
        </div>
        <div class="item">
            <div class="ins-inner-box">
                <img src="../images/instagram-img-05.jpg" alt="" />
                <div class="hov-in">
                    <a href="#"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
        </div>
        <div class="item">
            <div class="ins-inner-box">
                <img src="../images/instagram-img-06.jpg" alt="" />
                <div class="hov-in">
                    <a href="#"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
        </div>
        <div class="item">
            <div class="ins-inner-box">
                <img src="../images/instagram-img-07.jpg" alt="" />
                <div class="hov-in">
                    <a href="#"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
        </div>
        <div class="item">
            <div class="ins-inner-box">
                <img src="../images/instagram-img-08.jpg" alt="" />
                <div class="hov-in">
                    <a href="#"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
        </div>
        <div class="item">
            <div class="ins-inner-box">
                <img src="../images/instagram-img-09.jpg" alt="" />
                <div class="hov-in">
                    <a href="#"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
        </div>
        <div class="item">
            <div class="ins-inner-box">
                <img src="../images/instagram-img-05.jpg" alt="" />
                <div class="hov-in">
                    <a href="#"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
        </div>
    </div>
</div>
    <!-- End Instagram Feed  -->


    <!-- Start Footer  -->
    <div id="mainfooterplaceholder"></div>
    <!-- End Footer  -->

    <!-- Start copyright  -->
     <div class="footer-copyright">
        <p class="footer-company">All Rights Reserved. &copy; 2018 <a href="#">ThewayShop</a> Design By :
            <a href="https://html.design/">html design</a></p>
    </div>
  
    <!-- End copyright  -->

    <a href="#" id="back-to-top" title="Back to top" style="display: none;">&uarr;</a>


    <!--js -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
        $(document).ready(function () {
          const token = getToken(); 
          $.ajax({
            type: "GET",
            url: "http://localhost:8080/User/account",
            headers: {
              'Authorization': `Bearer ${token}`
            },
            dataType: "json",
            success: function (user) {
              console.log(user);
              setimgpro(user.picture);
              console.log(getimgpro())
              $("#fullname").val(user.fullname);
              $("#username").val(user.username);
              $("#email").val(user.email);
              $("#address").val(user.address);
              $("#phone").val(user.phone);
              $("#picture").val(user.picture);
              
            }
            ,error: function(){
                console.log(error);
            }
          });
      
          // Handle form submission
          $("#sub").click(function () {
            const token = getToken(); 
            
            var path = $("#picture").val().replace(/C:\\fakepath\\/, '')
            console.log(path);
            var formData = {
                                    username: $("#username").val(),
                                    fullname: $("#fullname").val(),
                                    phone: $("#phone").val(),
                                    address: $("#address").val(),
                                    picture: path || getimgpro()
                                

                                };
            
            console.log("submit");
            console.log(formData);
      
            $.ajax({
              type: "POST",
              url: "http://localhost:8080/User/editaccount",
              contentType: "application/json",
                                    data: JSON.stringify(formData),
                                    dataType: "json",
              headers: getAuthHeaders(),
              success: function (response) {
                setimgpro(null);
                $("#message").text("Profile updated successfully!").css("color", "green");
                setTimeout(() => {
                  window.location.replace("http://localhost:8080/my-account.html");
                }, 1500);
              },
              error: function (xhr, status, error) {
                console.error("Error updating profile:", error);
                $("#message").text("Failed to update profile.").css("color", "red");
              }
            });
          });
        });
      
        
      </script>
      
        
                    
    <!--end of js-->

    <!-- ALL JS FILES -->
    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <!-- ALL PLUGINS -->
    <script src="js/jquery.superslides.min.js"></script>
    <script src="js/bootstrap-select.js"></script>
    <script src="js/inewsticker.js"></script>
    <script src="js/bootsnav.js."></script>
    <script src="js/images-loded.min.js"></script>
    <script src="js/isotope.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/baguetteBox.min.js"></script>
    <script src="js/form-validator.min.js"></script>
    <script src="js/contact-form-script.js"></script>
    <script src="js/custom.js"></script>

    <script>
        $(function(){
            $("#//").load("Basics/instagram.html");
            $("#mainfooterplaceholder").load("Basics/mainFooter.html");
            $("#navPlaceholder").load("Basics/nav.html")
        });
    </script>
</body>

</html>