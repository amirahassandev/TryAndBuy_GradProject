<!DOCTYPE html>
<html lang="en">
<!-- Basic -->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- Mobile Metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Site Metas -->
    <title>SAN Shop</title>
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Site Icons -->
    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <!-- Site CSS -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/profile.css">
    <!-- Responsive CSS -->
    <link rel="stylesheet" href="css/responsive.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/custom.css">

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script src="js/holder.js" defer></script>

</head>

<body>

    <!-- Start Main Top -->


    <!-- Start Main Top -->
    <header class="main-header">
        <!-- Start Navigation -->
       <div id="navPlaceholder"></div>
        <!-- End Navigation -->
    </header>
    <!-- End Main Top -->



    <!-- Start All Title Box -->
    <div class="all-title-box">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <h2>My Account</h2>
                    <ul class="breadcrumb">
                        <li class="breadcrumb-item"><a href="shop.html">Shop</a></li>
                        <li class="breadcrumb-item active">My Account</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <!-- End All Title Box -->

    <!-- Start My Account  -->
    <div class="contain">
        <aside class="sidebar">
          <ul>
            <li><strong>ACCOUNT</strong></li>
            <li><a href="cart.html">Cart</a></li>
            <!-- <li>ORDERS HISTORY</li> -->
            <li><a href="editprofile.html">Edit Profile</a></li>
            <li><a href="login.html">Log Out</a></li>
          </ul>
        </aside>
    
        <main class="main-content">
          
          <div class="profile-box">
            <img alt="Avatar" id="image">
            
            <div class="profile-info">
              <p>Username:<span class="username">username</span></p>
              <p>Email: <span class="email">email</span></p>
              <p>Phone: <span class="phone">phone</span></p>
              <p>Fullname: <span class="fullname">fullname</span></p>
            </div>
          </div>
    
          <div class="address-section">
            <div class="address-box">
              üìç<p>Address: <span class="address">address</span></p>
            </div>

          </div>
    
          
    
          <section class="orders-section">
            <h3>Your orders</h3>
            <div id="orders">
                <div id="order-box">
                    
                    <div id="order-header">
                    </div>
             
              <div id="order-details">
                </div>
                <!-- <div>
                  <strong>Shipping address</strong><br />
                  <span class="address">address</span>
                </div> -->
                

                
                
              
              
            </div> 
            </div>
           
          </section>
        </main>
      </div> 
     
    <!-- End My Account -->
     <!-- Start Instagram Feed  -->
    <div class="instagram-box">
    <div class="main-instagram owl-carousel owl-theme">
        <div class="item">
            <div class="ins-inner-box">
                <img src="../images/instagram-img-01.jpg" alt="" />
                <div class="hov-in">
                    <a href="#"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
        </div>
        <div class="item">
            <div class="ins-inner-box">
                <img src="../images/instagram-img-02.jpg" alt="" />
                <div class="hov-in">
                    <a href="#"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
        </div>
        <div class="item">
            <div class="ins-inner-box">
                <img src="../images/instagram-img-03.jpg" alt="" />
                <div class="hov-in">
                    <a href="#"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
        </div>
        <div class="item">
            <div class="ins-inner-box">
                <img src="../images/instagram-img-04.jpg" alt="" />
                <div class="hov-in">
                    <a href="#"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
        </div>
        <div class="item">
            <div class="ins-inner-box">
                <img src="../images/instagram-img-05.jpg" alt="" />
                <div class="hov-in">
                    <a href="#"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
        </div>
        <div class="item">
            <div class="ins-inner-box">
                <img src="../images/instagram-img-06.jpg" alt="" />
                <div class="hov-in">
                    <a href="#"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
        </div>
        <div class="item">
            <div class="ins-inner-box">
                <img src="../images/instagram-img-07.jpg" alt="" />
                <div class="hov-in">
                    <a href="#"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
        </div>
        <div class="item">
            <div class="ins-inner-box">
                <img src="../images/instagram-img-08.jpg" alt="" />
                <div class="hov-in">
                    <a href="#"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
        </div>
        <div class="item">
            <div class="ins-inner-box">
                <img src="../images/instagram-img-09.jpg" alt="" />
                <div class="hov-in">
                    <a href="#"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
        </div>
        <div class="item">
            <div class="ins-inner-box">
                <img src="../images/instagram-img-05.jpg" alt="" />
                <div class="hov-in">
                    <a href="#"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
        </div>
    </div>
</div>
    <!-- End Instagram Feed  -->


    <!-- Start Footer  -->
    <div id="mainfooterplaceholder"></div>
    <!-- End Footer  -->
    <!-- End Footer  -->

    <!-- Start copyright  -->
    <div class="footer-copyright">
        <p class="footer-company">All Rights Reserved. &copy; 2025 <a href="#"> Try & Buy</a>
    </div>
    <!-- End copyright  -->

    <a href="#" id="back-to-top" title="Back to top" style="display: none;">&uarr;</a>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script>
  $(document).ready(function () {
    function getToken() {
  return localStorage.getItem("token"); // or however you store your token
}

    const token = getToken();

    // Fetch User Info
    $.ajax({
      type: "GET",
      url: "http://localhost:8080/User/account",
      headers: {
        'Authorization': `Bearer ${token}`
      },
      success: function (user) {
        $(".fullname").text(user.fullname);
        $(".username").text(user.username);
        $(".email").text(user.email);
        $(".phone").text(user.phone);
        $("#image").attr("src", user.picture);


        const addressSection = $(".address-box");
        addressSection.empty();
        var order_details = `<div>
                  <img src="${user.picture}" alt="Avatar" id="image">
                  <strong>Contact</strong><br />
                  <span class="username">${user.username}</span><br />
                  Phone: <span class="phone">${user.phone}</span><br />
                  Email: <span class="email">${user.email}</span>
                </div>`;
        if (Array.isArray(user.addresses)) {
          user.addresses.forEach(addr => {
            addressSection.append(`
              <div class="address-box">
                üìç <p>Address: <span class="address">${addr}</span></p>
              </div>
            `);
          });
        } else if (user.address) {
          addressSection.append(`
            <div class="address-box">
              üìç <p>Address: <span class="address">${user.address}</span></p>
            </div>
          `);
        }
      }
      
    })});







    // Fetch Orders










$(document).ready(function () {
  $.ajax({
    type: "GET",
    url: "http://localhost:8080/Car/orders",
    headers: getAuthHeaders(),
    dataType: "json",
    success: function (cars) {
      console.log("cars: ", cars);
      let orderHtml = ``;
      

      cars.forEach(car => {
        const orderId = car.id;
        const products = car.ProductsOfCarDto;

        // Generate product HTML per order
        let productList = ``;
        let payments = ``;
        
        products.forEach(product => {
          productList += `
            <div style="margin: 0 0 5px 15%; display: flex; justify-content: space-evenly;
                        border-radius: 16px; border: 6px solid white; width: 75%;">
              <img src="images/${product.image}" style="height: 100px;" alt="Headset" />
              <div>
                <p>Desc: ${product.description}</p>
                <p>Quantity: ${product.quantity}</p>
                <p>Price: ${product.productPrice}</p>
              </div>
            </div>
          `;
        });

        payments +=
          `
            <strong>Payment</strong><br />
            
            Shipping fee: <span class="shipping">${car.shippingCost}</span><br />
            Total paid: <span class="total">${car.totalAmount}</span>
          `; 

        // Full order section
        orderHtml += `
          <div class="order">
            <div>
              <strong>Order ID:</strong>
              <span class="order-id">${car.id}</span> 
              <span style="color:green;">
                <strong>Status:</strong>
                <span class="status">${car.status}</span>
              </span>
            </div>

            <div>Date: <span class="car_date">${car.carDate}</span></div>

            <div class="products">
              ${productList}
            </div>

            <div class="payment" id="payment-${orderId}">
              ${payments}
            </div>

            <hr />
          </div>
        `;
      });

      $('#order-header').html(orderHtml);
    },
  });
});





















    // $(document).ready(function () {
    // // or however you store your token


    // //const token = getToken();
    //   $.ajax({
    //     type: "GET",
    //     url: "http://localhost:8080/Car/orders",
    //     headers:getAuthHeaders(),
    //     dataType:"json",
    //     success: function (cars) {
    //     console.log("cars: ",cars)
          
    //     var orderDiv = ``
    //     var productList = ``
    //     var payments = `` 
    //     var id = 0
    //     cars.forEach(car => {
    //       id = car.id
    //       orderDiv +=
    //       `
    //         <div>
    //           <strong>Order ID:</strong>
    //           <span class="order-id">${car.id}</span> 
    //           <span style="color:green;">
    //             <span class="status">${car.status}</span>
    //           </span>
    //         </div>

    //         <div>Date: 
    //             <span class="car_date">${car.carDate}</span>
    //         </div>

    //         <div id="productsItem">
    //         </div>

    //         <div id="payment"></div>
    //         -------------------------------------------------------------------
    //       `;

          
    //       var products = car.ProductsOfCarDto
    //       console.log("its our products",products)

    //       products.forEach(product =>{
    //         console.log("desc: ", product.description)
    //         productList +=
    //           ` 
    //           <div style= "    margin: 0 0 5px 15%;
    //                         display: flex
    //                     ;
    //                         justify-content: space-evenly;
    //                         border-radius: 16px;
    //                         border: 6px solid gray;
    //                         width: 75%;">
    //             <img src="images/${product.image}" style="height: 100px;" alt="Headset" />
    //             <div>
    //               <p>Desc: ${product.description}</p>
    //               <p>Quantity: ${product.quantity}</p>
    //               <p>price: ${product.productPrice}</p>
    //             </div>
    //           </div>
    //           `;  
    //       });
        

    //     });
        
    //     $('#order-header').html(orderDiv)
    //     $('#productsItem').html(productList)

    // }})});
   

    // Payment & products
        // cars.forEach(car => {
          

          // console.log("car:", car["shippingCost"])

          

          

          
          
        

        // console.log("product",car.ProductsOfCarDto) 
        
        
        
        // $('#payment').html(payments) 
    
    // });
    
      
      // }})});
  

</script>

 <script>
    $(function(){
        $("#mainfooterplaceholder").load("Basics/mainFooter.html");
        $("#navPlaceholder").load("Basics/nav.html")
    });
</script>

    <!-- ALL JS FILES -->
    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <!-- ALL PLUGINS -->
    <script src="js/jquery.superslides.min.js"></script>
    <script src="js/bootstrap-select.js"></script>
    <script src="js/inewsticker.js"></script>
    <script src="js/bootsnav.js."></script>
    <script src="js/images-loded.min.js"></script>
    <script src="js/isotope.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/baguetteBox.min.js"></script>
    <script src="js/form-validator.min.js"></script>
    <script src="js/contact-form-script.js"></script>
    <script src="js/custom.js"></script>

    <script>
        $(function(){
            $("#//").load("Basics/instagram.html");
            $("#mainfooterplaceholder").load("Basics/mainFooter.html");
            $("#navPlaceholder").load("Basics/nav.html")
        });
    </script>
</body>

</html>